# 综合功能测试指南

## 测试时间
2026-01-20

## 测试目标
验证 AI 集成规范阶段 1-4 的所有核心功能是否正常工作。

---

## 测试环境准备

### 1. 启动开发服务器

```bash
# 启动 Expo 开发服务器
npm start
```

### 2. 选择测试平台

- **Web 测试**: 按 `w` 键在浏览器中打开
- **Android 测试**: 按 `a` 键（需要 Android 模拟器或真机）
- **iOS 测试**: 按 `i` 键（需要 Mac + iOS 模拟器）

---

## 测试清单

### ✅ 阶段 1: 后端基础设施

#### 测试 1.1: 后端 API 服务
**测试目标**: 验证后端 API 端点是否可用

**测试步骤**:
1. 打开浏览器访问: `http://localhost:3000/api/test-api.js`
2. 或运行测试脚本:
```bash
node api/test-api.js
```

**预期结果**:
- ✅ API 端点响应正常
- ✅ CORS 配置正确
- ✅ 环境变量加载成功

---

#### 测试 1.2: 阿里云 OCR API
**测试目标**: 验证 OCR 识别功能

**测试步骤**:
1. 运行 OCR 测试脚本:
```bash
node api/test-ocr-simple.js
```

**预期结果**:
- ✅ OCR API 调用成功
- ✅ 返回识别结果
- ✅ 签名算法正确

**注意**: 需要配置 `.env.local` 中的阿里云密钥

---

#### 测试 1.3: DeepSeek API
**测试目标**: 验证 AI 分析功能

**测试步骤**:
1. 运行 DeepSeek 测试脚本:
```bash
node api/test-deepseek.js
```

**预期结果**:
- ✅ DeepSeek API 调用成功
- ✅ 返回 JSON 格式的分析结果
- ✅ 错误分析和学习路径生成正常

**注意**: 需要配置 `.env.local` 中的 DeepSeek API 密钥

---

### ✅ 阶段 2: 前端核心功能

#### 测试 2.1: 图像处理
**测试目标**: 验证图像压缩和质量检测

**测试步骤**:
1. 启动应用
2. 进入扫描页面
3. 选择一张大于 4MB 的图片

**预期结果**:
- ✅ 图片自动压缩到 4MB 以下
- ✅ 显示压缩进度
- ✅ 保持图片清晰度

---

#### 测试 2.2: 答案提取
**测试目标**: 验证答案提取逻辑

**测试步骤**:
1. 使用标准答题卡图片
2. 完成 OCR 识别
3. 查看提取的答案

**预期结果**:
- ✅ 正确提取选择题答案（A/B/C/D）
- ✅ 答案数量与题目数量一致
- ✅ 置信度显示正确

---

#### 测试 2.3: 答案评分
**测试目标**: 验证评分准确性

**测试步骤**:
1. 完成答案提取
2. 系统自动评分
3. 查看评分结果

**预期结果**:
- ✅ 总分计算正确
- ✅ 正确率准确
- ✅ 维度得分显示
- ✅ 错题统计正确

---

### ✅ 阶段 3: UI 集成和用户体验

#### 测试 3.1: 扫描页面
**测试目标**: 验证完整扫描流程

**测试步骤**:
1. 点击"开始 AI 诊断"
2. 选择答题卡图片
3. 点击"开始扫描"
4. 观察处理进度

**预期结果**:
- ✅ 文件选择正常
- ✅ 显示处理进度（压缩→识别→提取→评分→分析→生成路径）
- ✅ 每个阶段有明确提示
- ✅ 错误处理正确

**测试场景**:
- ✅ 正常图片
- ✅ 超大图片（>10MB）
- ✅ 模糊图片
- ✅ 错误格式文件

---

#### 测试 3.2: 报告页面
**测试目标**: 验证报告显示和交互

**测试步骤**:
1. 完成扫描后自动跳转到报告页面
2. 查看各个报告模块
3. 测试交互功能

**预期结果**:
- ✅ 核心计分板显示正确
- ✅ 五维能力分析显示
- ✅ 深度分析内容完整
- ✅ 知识点矩阵清晰
- ✅ 提分路径详细
- ✅ 赛博朋克风格一致

---

#### 测试 3.3: 历史记录
**测试目标**: 验证历史记录功能

**测试步骤**:
1. 点击"历史记录"
2. 查看历史报告列表
3. 点击某个报告查看详情
4. 测试清空功能

**预期结果**:
- ✅ 显示所有历史报告
- ✅ 按时间倒序排列
- ✅ 点击可查看详情
- ✅ 清空功能正常
- ✅ 数据持久化（刷新后仍存在）

---

#### 测试 3.4: 报告导出
**测试目标**: 验证导出和分享功能

**Web 端测试**:
1. 打开报告页面
2. 点击"导出"按钮
3. 测试分享功能

**预期结果**:
- ✅ 显示分享对话框（如果浏览器支持）
- ✅ 或复制到剪贴板
- ✅ 显示成功提示

**移动端测试**:
1. 打开报告页面
2. 点击"导出"按钮
3. 选择"导出为图片"
4. 查看分享选项

**预期结果**:
- ✅ 显示导出选项对话框
- ✅ 截图成功
- ✅ 图片质量良好
- ✅ 分享功能正常
- ✅ 文件保存成功

---

### ✅ 阶段 4: 高级功能

#### 测试 4.1: 批量处理
**测试目标**: 验证批量上传和处理

**测试步骤**:
1. 点击"批量处理"
2. 选择多张图片（建议 3-5 张）
3. 点击"开始批量处理"
4. 观察处理进度
5. 查看统计结果

**预期结果**:
- ✅ 支持多文件选择（最多 50 张）
- ✅ 显示文件列表
- ✅ 并发处理（最多 3 个）
- ✅ 实时进度显示
- ✅ 统计信息准确
- ✅ 导出 Excel 功能

**测试场景**:
- ✅ 少量文件（1-3 张）
- ✅ 中等数量（10-20 张）
- ✅ 大量文件（接近 50 张）
- ✅ 超过限制（>50 张）

---

#### 测试 4.2: 多语言支持
**测试目标**: 验证语言切换功能

**测试步骤**:
1. 点击"设置"
2. 切换语言（中文 ↔ 英文）
3. 返回各个页面查看

**预期结果**:
- ✅ 所有界面文本切换
- ✅ 按钮文本切换
- ✅ 错误消息切换
- ✅ 报告内容切换
- ✅ AI 分析结果切换
- ✅ 语言偏好保存

**测试页面**:
- ✅ 首页
- ✅ 扫描页面
- ✅ 报告页面
- ✅ 历史记录页面
- ✅ 批量处理页面
- ✅ 设置页面

---

## 性能测试

### 测试 5.1: 响应时间
**测试目标**: 验证各功能的响应时间

**测试项目**:
1. OCR 识别: 应在 5 秒内完成
2. AI 分析: 应在 10 秒内完成
3. 学习路径生成: 应在 8 秒内完成
4. 页面加载: 应在 2 秒内完成

**测试方法**:
```bash
node api/test-performance.js
```

---

### 测试 5.2: 并发处理
**测试目标**: 验证批量处理的并发控制

**测试步骤**:
1. 上传 10 张图片
2. 开始批量处理
3. 观察并发数量

**预期结果**:
- ✅ 同时处理最多 3 个任务
- ✅ 队列管理正确
- ✅ 进度显示准确

---

### 测试 5.3: 缓存机制
**测试目标**: 验证缓存功能

**测试步骤**:
1. 扫描同一张图片两次
2. 观察第二次的处理时间

**预期结果**:
- ✅ 第二次明显更快
- ✅ 使用缓存的 OCR 结果
- ✅ 缓存过期机制正常

---

## 错误处理测试

### 测试 6.1: 网络错误
**测试场景**:
1. 断开网络连接
2. 尝试扫描

**预期结果**:
- ✅ 显示"网络连接失败"提示
- ✅ 提供重试选项
- ✅ 不会崩溃

---

### 测试 6.2: API 错误
**测试场景**:
1. 使用错误的 API 密钥
2. 尝试扫描

**预期结果**:
- ✅ 显示"服务暂时不可用"提示
- ✅ 记录错误日志
- ✅ 不暴露敏感信息

---

### 测试 6.3: 图片质量问题
**测试场景**:
1. 上传模糊图片
2. 上传非答题卡图片

**预期结果**:
- ✅ 显示"图像识别失败"提示
- ✅ 提示用户重新拍摄
- ✅ 提供质量检测反馈

---

## 跨平台测试

### 测试 7.1: Web 端
**测试浏览器**:
- ✅ Chrome
- ✅ Firefox
- ✅ Safari
- ✅ Edge

**测试功能**:
- ✅ 文件上传
- ✅ 报告显示
- ✅ 分享功能
- ✅ 响应式布局

---

### 测试 7.2: Android 端
**测试设备**:
- ✅ Android 模拟器
- ✅ 真机测试

**测试功能**:
- ✅ 相机拍照
- ✅ 图片选择
- ✅ 报告导出
- ✅ 原生分享

---

### 测试 7.3: iOS 端（可选）
**测试设备**:
- ✅ iOS 模拟器
- ✅ 真机测试

**测试功能**:
- ✅ 相机拍照
- ✅ 图片选择
- ✅ 报告导出
- ✅ 原生分享

---

## 测试报告模板

### 测试结果记录

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 后端 API 服务 | ⬜ 通过 / ⬜ 失败 | |
| OCR 识别 | ⬜ 通过 / ⬜ 失败 | |
| AI 分析 | ⬜ 通过 / ⬜ 失败 | |
| 图像处理 | ⬜ 通过 / ⬜ 失败 | |
| 答案提取 | ⬜ 通过 / ⬜ 失败 | |
| 答案评分 | ⬜ 通过 / ⬜ 失败 | |
| 扫描页面 | ⬜ 通过 / ⬜ 失败 | |
| 报告页面 | ⬜ 通过 / ⬜ 失败 | |
| 历史记录 | ⬜ 通过 / ⬜ 失败 | |
| 报告导出 | ⬜ 通过 / ⬜ 失败 | |
| 批量处理 | ⬜ 通过 / ⬜ 失败 | |
| 多语言支持 | ⬜ 通过 / ⬜ 失败 | |
| 性能测试 | ⬜ 通过 / ⬜ 失败 | |
| 错误处理 | ⬜ 通过 / ⬜ 失败 | |

---

## 已知问题

### 问题 1: 依赖警告
**描述**: npm install 时显示 19 个漏洞警告
**影响**: 低
**解决方案**: 运行 `npm audit fix` 修复非破坏性问题

### 问题 2: AbilityRadar 组件
**描述**: 雷达图组件临时注释
**影响**: 中
**解决方案**: 使用简化的能力列表显示

---

## 测试工具

### 开发工具
- **React DevTools**: 检查组件状态
- **Network Tab**: 监控 API 调用
- **Console**: 查看日志和错误

### 测试脚本
```bash
# 运行所有测试
npm test

# 运行 API 测试
node api/test-api.js

# 运行 OCR 测试
node api/test-ocr-simple.js

# 运行 DeepSeek 测试
node api/test-deepseek.js

# 运行性能测试
node api/test-performance.js
```

---

## 测试建议

### 优先级 P0（必须测试）
1. ✅ 扫描流程（端到端）
2. ✅ 报告显示
3. ✅ 历史记录
4. ✅ 错误处理

### 优先级 P1（重要测试）
1. ✅ 批量处理
2. ✅ 多语言切换
3. ✅ 报告导出
4. ✅ 性能测试

### 优先级 P2（可选测试）
1. ✅ 跨浏览器兼容性
2. ✅ 移动端测试
3. ✅ 边界情况

---

## 测试完成标准

### 核心功能
- ✅ 所有 P0 测试通过
- ✅ 至少 80% 的 P1 测试通过
- ✅ 无严重 bug

### 用户体验
- ✅ 界面流畅
- ✅ 提示清晰
- ✅ 错误处理友好

### 性能指标
- ✅ OCR < 5 秒
- ✅ AI 分析 < 10 秒
- ✅ 页面加载 < 2 秒

---

## 下一步

测试完成后，根据结果决定：

1. **如果测试通过** → 继续部署到生产环境
2. **如果发现问题** → 修复 bug 后重新测试
3. **如果需要优化** → 记录优化建议，后续迭代

---

## 联系方式

如有问题，请查看：
- `DEVELOPMENT.md` - 开发指南
- `MOCK_MODE_TEST_GUIDE.md` - Mock 模式测试
- `NETWORK_TROUBLESHOOTING.md` - 网络问题排查

祝测试顺利！🚀
