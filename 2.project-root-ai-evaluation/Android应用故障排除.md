# Android应用故障排除指南

## 当前状态

✅ **应用已成功运行** - 登录界面正常显示
✅ **后端服务运行中** - http://localhost:8000
⚠️ **注册遇到HTTP 400错误**

## 问题：HTTP 400 Bad Request

### 最可能的原因

**未先发送验证码！** 这是最常见的问题。

### 正确的注册流程

```
1. 输入手机号（11位）
   ↓
2. 点击"发送验证码"按钮 ← 必须！
   ↓
3. 等待提示"验证码已发送"
   ↓
4. 输入验证码（6位数字）
   ↓
5. 输入密码（至少6位）
   ↓
6. 点击"注册"按钮
```

## 详细测试步骤

### 步骤1：打开注册界面
- 在登录界面点击"还没有账号？去注册"

### 步骤2：输入手机号
- 输入：`13800138000`
- 或任意11位以1开头的数字

### 步骤3：发送验证码 ⚠️ 关键步骤
- **点击"发送验证码"按钮**
- 等待按钮变为倒计时状态（例如"59秒"）
- 这一步会调用后端API生成验证码记录

### 步骤4：输入验证码
- Mock模式下，输入任意6位数字即可
- 例如：`123456`、`888888`、`000000`

### 步骤5：输入密码
- 至少6位字符
- 例如：`password123`

### 步骤6：点击注册
- 点击"注册"按钮
- 等待处理

## 如果仍然失败

### 检查1：后端服务状态
```cmd
curl http://localhost:8000/health
```
应该返回：`{"status":"healthy","version":"1.0.0"}`

### 检查2：查看后端日志
```cmd
docker logs exam_assessment_backend_mock --tail 50
```

### 检查3：查看Android Logcat
在Android Studio中：
1. 打开Logcat窗口
2. 过滤：`ExamAI`
3. 查看网络请求的详细信息

### 检查4：验证API地址配置
文件：`android/app/src/main/res/values/strings.xml`
```xml
<string name="api_base_url">http://10.0.2.2:8000/</string>
```

## 其他可能的问题

### 问题1：网络连接失败
**错误：** `failed to connect to /10.0.2.2`

**解决：**
- 确认后端服务正在运行
- 检查防火墙设置
- 重启后端服务

### 问题2：验证码格式错误
**错误：** `验证码格式不正确`

**解决：**
- 确保输入6位数字
- 不要包含空格或其他字符

### 问题3：手机号格式错误
**错误：** `Phone number must be 11 digits`

**解决：**
- 输入11位数字
- 必须以1开头
- 例如：13800138000

### 问题4：密码太短
**错误：** `密码至少6位`

**解决：**
- 输入至少6个字符
- 可以包含字母、数字、符号

## 成功注册后

注册成功后会：
1. 自动登录
2. 跳转到主界面
3. 显示三个功能按钮：
   - 拍摄试卷（实时指导）
   - 快速拍照
   - 历史记录

## 测试完整流程

### 1. 注册新用户
- 手机号：`13800138000`
- 验证码：`123456`
- 密码：`password123`

### 2. 登录
- 使用刚才注册的账号登录

### 3. 测试拍照功能
- 点击"快速拍照"
- 选择或拍摄图片
- 查看上传进度

### 4. 查看历史记录
- 点击"历史记录"
- 查看之前上传的试卷

## 需要帮助？

如果按照以上步骤仍然无法解决问题，请提供：

1. **具体的错误信息**
   - 截图或文字描述

2. **操作步骤**
   - 详细说明你做了什么

3. **后端日志**
   ```cmd
   docker logs exam_assessment_backend_mock --tail 100 > backend-log.txt
   ```

4. **Android Logcat日志**
   - 在Android Studio中导出Logcat

这样我可以更准确地帮你解决问题！
